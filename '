section text
.start
    ; test fopen
    call @echotest

    halt

func print # r1 - data, r3 - heap count
    push r2 

    uload r2 1 ; stdout
    ncall 1 r0

    pop r2
    ret

func input # r1 - data, r2 - max to read 
    ncall 2 r0 
    ret

   
func sleep # r1 is time in millis
    ncall 6 r0
    ret
    ret

func echotest
    uload r3 36
    allocr r1 r3
    dslea r2 cmd 9 
    uload r3 22

    storedat r1 r2 r3

    uload r4 150
    allocr r5 r4
    uload r4 140

    movr r2 r3
    movr r3 r5
    ncall 7 r0

    movr r3 r0
    movr r1 r5
    call @print
    ret

section data 
    cmd str "echo "test""
